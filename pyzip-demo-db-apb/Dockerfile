FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDY0Mjk3ZTg4LTY1N2MtNDZhYi1iYjUwLTJhZjdmODRlNWVjNgpuYW1lOiBweXppcC1kZW1v\
LWRiLWFwYgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL3B5emlwLWRlbW8tZGItYXBiCmRl\
c2NyaXB0aW9uOiBQeXRob24gWmlwIERlbW8gRGF0YWJhc2UgQVBCIEltcGxlbWVudGF0aW9uCmJp\
bmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YTogCiAgZG9jdW1lbnRhdGlvblVy\
bDogaHR0cHM6Ly9naXRodWIuY29tL2Z1c29yL2FwYi1leGFtcGxlcy90cmVlL21hc3Rlci9weXpp\
cC1kZW1vLWRiLWFwYgogIGxvbmdEZXNjcmlwdGlvbjogQSBkYXRhYmFzZSB3aXRoIEdJUyBzdXBw\
b3J0IGFuZCBzZWVkZWQgZGF0YSBmb3IgYSBkZW1vbnN0cmF0aW9uIHB5dGhvbiB3ZWJhcHAsIGh0\
dHBzOi8vZ2l0aHViLmNvbS9mdXNvci9weS16aXAtZGVtbwogIGRpc3BsYXlOYW1lOiBQeXppcCBE\
ZW1vIERhdGFiYXNlIChBUEIpCiAgZGVwZW5kZW5jaWVzOiBbJ2RvY2tlci5pby9mYWJpYW52Zi9w\
b3N0Z3Jlc3FsOnBvc3RnaXMnXQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNv\
bi1wb3N0Z3Jlc3FsCiAgCnBhcmFtZXRlcnM6IAogIC0gZGF0YWJhc2VfbmFtZToKICAgICAgZGVm\
YXVsdDogYWRtaW4KICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBEYXRhYmFzZSBOYW1l\
CiAgICAgIAogIC0gZGF0YWJhc2VfcGFzc3dvcmQ6CiAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAg\
IHR5cGU6IHN0cmluZwogICAgICBkZXNjcmlwdGlvbjogQSByYW5kb20gYWxwaGFudW1lcmljIHN0\
cmluZyBpZiBsZWZ0IGJsYW5rCiAgICAgIHRpdGxlOiBEYXRhYmFzZSBQYXNzd29yZAogICAgICAK\
ICAtIGRhdGFiYXNlX3VzZXI6CiAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgIHRpdGxlOiBEYXRh\
YmFzZSBVc2VyCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBtYXhsZW5ndGg6IDYzCiAgICAgIAog\
IApyZXF1aXJlZDogCiAgLSBkYXRhYmFzZV9uYW1lCiAgLSBkYXRhYmFzZV91c2VyCiAg"

COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions

RUN yum install -y postgresql && yum clean all

USER apb
